Posh-Metasploit
===============

PowerShell module to automate via XMLRPC a remote Metasploit server.


##Commands
<pre>
CommandType     Name                                               ModuleName                                                                                         
-----------     ----                                               ----------                                                                                         
Function        Connect-MSFDB                                      Posh-Metasploit                                                                                    
Function        Disconnect-MSFDB                                   Posh-Metasploit                                                                                    
Function        Get-MSFAuthToken                                   Posh-Metasploit                                                                                    
Function        Get-MSFAuxiliaryModule                             Posh-Metasploit                                                                                    
Function        Get-MSFConsole                                     Posh-Metasploit                                                                                    
Function        Get-MSFCoreInfo                                    Posh-Metasploit                                                                                    
Function        Get-MSFDBCred                                      Posh-Metasploit                                                                                    
Function        Get-MSFDBCurrentWorspace                           Posh-Metasploit                                                                                    
Function        Get-MSFDBEvent                                     Posh-Metasploit                                                                                    
Function        Get-MSFDBHost                                      Posh-Metasploit                                                                                    
Function        Get-MSFDBLoot                                      Posh-Metasploit                                                                                    
Function        Get-MSFDBNote                                      Posh-Metasploit                                                                                    
Function        Get-MSFDBServcie                                   Posh-Metasploit                                                                                    
Function        Get-MSFDBStatus                                    Posh-Metasploit                                                                                    
Function        Get-MSFDBVuln                                      Posh-Metasploit                                                                                    
Function        Get-MSFDBWorspace                                  Posh-Metasploit                                                                                    
Function        Get-MSFExploitCompatiblePayload                    Posh-Metasploit                                                                                    
Function        Get-MSFExploitModule                               Posh-Metasploit                                                                                    
Function        Get-MSFJob                                         Posh-Metasploit                                                                                    
Function        Get-MSFJobInfo                                     Posh-Metasploit                                                                                    
Function        Get-MSFLoadedPlugin                                Posh-Metasploit                                                                                    
Function        Get-MSFModuleInfo                                  Posh-Metasploit                                                                                    
Function        Get-MSFModuleOptions                               Posh-Metasploit                                                                                    
Function        Get-MSFModuleStats                                 Posh-Metasploit                                                                                    
Function        Get-MSFNOPS                                        Posh-Metasploit                                                                                    
Function        Get-MSFPayloadModule                               Posh-Metasploit                                                                                    
Function        Get-MSFPostCompatibleSession                       Posh-Metasploit                                                                                    
Function        Get-MSFPostModule                                  Posh-Metasploit                                                                                    
Function        Get-MSFServerSession                               Posh-Metasploit                                                                                    
Function        Get-MSFSession                                     Posh-Metasploit                                                                                    
Function        Get-MSFSessionCompatPostModule                     Posh-Metasploit                                                                                    
Function        Get-MSFThread                                      Posh-Metasploit                                                                                    
Function        Get-PoshMSFersion                                  Posh-Metasploit                                                                                    
Function        Import-MSFDBData                                   Posh-Metasploit                                                                                    
Function        Invoke-MSFConsoleCommand                           Posh-Metasploit                                                                                    
Function        Invoke-MSFMeterpreterCommand                       Posh-Metasploit                                                                                    
Function        Invoke-MSFModule                                   Posh-Metasploit                                                                                    
Function        Invoke-MSFModuleReload                             Posh-Metasploit                                                                                    
Function        New-MSFAuthToken                                   Posh-Metasploit                                                                                    
Function        New-MSFConsole                                     Posh-Metasploit                                                                                    
Function        New-MSFDBWorkspace                                 Posh-Metasploit                                                                                    
Function        New-MSFServerSession                               Posh-Metasploit                                                                                    
Function        Read-MSFConsole                                    Posh-Metasploit                                                                                    
Function        Read-MSFMeterpreterConsole                         Posh-Metasploit                                                                                    
Function        Read-MSFShellConsole                               Posh-Metasploit                                                                                    
Function        Register-MSFPlugin                                 Posh-Metasploit                                                                                    
Function        Remove-MSFAuthToken                                Posh-Metasploit                                                                                    
Function        Remove-MSFConsole                                  Posh-Metasploit                                                                                    
Function        Remove-MSFDBHost                                   Posh-Metasploit                                                                                    
Function        Remove-MSFDBNote                                   Posh-Metasploit                                                                                    
Function        Remove-MSFDBServcie                                Posh-Metasploit                                                                                    
Function        Remove-MSFDBVuln                                   Posh-Metasploit                                                                                    
Function        Remove-MSFDBWorkspace                              Posh-Metasploit                                                                                    
Function        Remove-MSFGlobalVariable                           Posh-Metasploit                                                                                    
Function        Remove-MSFJob                                      Posh-Metasploit                                                                                    
Function        Remove-MSFServerSession                            Posh-Metasploit                                                                                    
Function        Remove-MSFSession                                  Posh-Metasploit                                                                                    
Function        Remove-MSFThread                                   Posh-Metasploit                                                                                    
Function        Save-MSFConfig                                     Posh-Metasploit                                                                                    
Function        Set-MSFAuthToken                                   Posh-Metasploit                                                                                    
Function        Set-MSFDBCred                                      Posh-Metasploit                                                                                    
Function        Set-MSFDBHost                                      Posh-Metasploit                                                                                    
Function        Set-MSFDBNote                                      Posh-Metasploit                                                                                    
Function        Set-MSFDBServcie                                   Posh-Metasploit                                                                                    
Function        Set-MSFDBVuln                                      Posh-Metasploit                                                                                    
Function        Set-MSFDBWorkspace                                 Posh-Metasploit                                                                                    
Function        Set-MSFGlobalVariable                              Posh-Metasploit                                                                                    
Function        UnRegister-MSFPlugin                               Posh-Metasploit                                                                                    
Function        Write-MSFConsole                                   Posh-Metasploit                                                                                    
Function        Write-MSFMeterpreterConsole                        Posh-Metasploit                                                                                    
Function        Write-MSFShellConsole                              Posh-Metasploit        
</pre>

#Install
To install the module including all source code you can just run in a PowerShell v3 or higher session the following command:
<pre>
iex (New-Object Net.WebClient).DownloadString("https://gist.githubusercontent.com/darkoperator/9379735/raw/4a651c122700b5002b6a60f291663c8e742f4f98/PoshMetasploit.ps1")
</pre>

The process should look like:
<pre>
PS C:\> iex (New-Object Net.WebClient).DownloadString("https://gist.githubusercontent.com/darkoperator/9379735/raw/4a651c122700b5002b6a60f291663c8e742f4f98/PoshMetasploit.ps1")
Downloading latest version of Posh-Metasploit from https://github.com/darkoperator/Posh-Metasploit/archive/master.zip
File saved to C:\Users\Carlos\AppData\Local\Temp\Posh-Metasploit.zip
Uncompressing the Zip file to C:\Users\Carlos\Documents\WindowsPowerShell\Modules
Renaming folder
Module has been installed

CommandType     Name                                               ModuleName
-----------     ----                                               ----------
Function        Connect-MSFDB                                      Posh-Metasploit
Function        Disconnect-MSFDB                                   Posh-Metasploit
Function        Get-MSFAuthToken                                   Posh-Metasploit
Function        Get-MSFAuxiliaryModule                             Posh-Metasploit
Function        Get-MSFConsole                                     Posh-Metasploit
Function        Get-MSFCoreInfo                                    Posh-Metasploit
Function        Get-MSFDBCred                                      Posh-Metasploit
Function        Get-MSFDBCurrentWorspace                           Posh-Metasploit
Function        Get-MSFDBEvent                                     Posh-Metasploit
Function        Get-MSFDBHost                                      Posh-Metasploit
Function        Get-MSFDBLoot                                      Posh-Metasploit
Function        Get-MSFDBNote                                      Posh-Metasploit
Function        Get-MSFDBServcie                                   Posh-Metasploit
Function        Get-MSFDBStatus                                    Posh-Metasploit
Function        Get-MSFDBVuln                                      Posh-Metasploit
Function        Get-MSFDBWorspace                                  Posh-Metasploit
Function        Get-MSFExploitCompatiblePayload                    Posh-Metasploit
Function        Get-MSFExploitModule                               Posh-Metasploit
Function        Get-MSFJob                                         Posh-Metasploit
Function        Get-MSFJobInfo                                     Posh-Metasploit
Function        Get-MSFLoadedPlugin                                Posh-Metasploit
Function        Get-MSFModuleInfo                                  Posh-Metasploit
Function        Get-MSFModuleOptions                               Posh-Metasploit
Function        Get-MSFModuleStats                                 Posh-Metasploit
Function        Get-MSFNOPS                                        Posh-Metasploit
Function        Get-MSFPayloadModule                               Posh-Metasploit
Function        Get-MSFPostCompatibleSession                       Posh-Metasploit
Function        Get-MSFPostModule                                  Posh-Metasploit
Function        Get-MSFServerSession                               Posh-Metasploit
Function        Get-MSFSession                                     Posh-Metasploit
Function        Get-MSFSessionCompatPostModule                     Posh-Metasploit
Function        Get-MSFThread                                      Posh-Metasploit
Function        Get-PoshMSFersion                                  Posh-Metasploit
Function        Import-MSFDBData                                   Posh-Metasploit
Function        Invoke-MSFConsoleCommand                           Posh-Metasploit
Function        Invoke-MSFMeterpreterCommand                       Posh-Metasploit
Function        Invoke-MSFModule                                   Posh-Metasploit
Function        Invoke-MSFModuleReload                             Posh-Metasploit
Function        New-MSFAuthToken                                   Posh-Metasploit
Function        New-MSFConsole                                     Posh-Metasploit
Function        New-MSFDBWorkspace                                 Posh-Metasploit
Function        New-MSFServerSession                               Posh-Metasploit
Function        Read-MSFConsole                                    Posh-Metasploit
Function        Read-MSFMeterpreterConsole                         Posh-Metasploit
Function        Read-MSFShellConsole                               Posh-Metasploit
Function        Register-MSFPlugin                                 Posh-Metasploit
Function        Remove-MSFAuthToken                                Posh-Metasploit
Function        Remove-MSFConsole                                  Posh-Metasploit
Function        Remove-MSFDBHost                                   Posh-Metasploit
Function        Remove-MSFDBNote                                   Posh-Metasploit
Function        Remove-MSFDBServcie                                Posh-Metasploit
Function        Remove-MSFDBVuln                                   Posh-Metasploit
Function        Remove-MSFDBWorkspace                              Posh-Metasploit
Function        Remove-MSFGlobalVariable                           Posh-Metasploit
Function        Remove-MSFJob                                      Posh-Metasploit
Function        Remove-MSFServerSession                            Posh-Metasploit
Function        Remove-MSFSession                                  Posh-Metasploit
Function        Remove-MSFThread                                   Posh-Metasploit
Function        Save-MSFConfig                                     Posh-Metasploit
Function        Set-MSFAuthToken                                   Posh-Metasploit
Function        Set-MSFDBCred                                      Posh-Metasploit
Function        Set-MSFDBHost                                      Posh-Metasploit
Function        Set-MSFDBNote                                      Posh-Metasploit
Function        Set-MSFDBServcie                                   Posh-Metasploit
Function        Set-MSFDBVuln                                      Posh-Metasploit
Function        Set-MSFDBWorkspace                                 Posh-Metasploit
Function        Set-MSFGlobalVariable                              Posh-Metasploit
Function        UnRegister-MSFPlugin                               Posh-Metasploit
Function        Write-MSFConsole                                   Posh-Metasploit
Function        Write-MSFMeterpreterConsole                        Posh-Metasploit
Function        Write-MSFShellConsole                              Posh-Metasploit
</pre>